<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chat App - Opal + WebSocket</title>
    <link rel="stylesheet" href="/app/styles.css" />
  </head>
  <body>
    <div class="app-container" data-controller="chat">
      <!-- Login Screen -->
      <div class="login-container" data-chat-target="loginContainer">
        <div class="login-card">
          <h1>ðŸ’¬ WebSocket Chat</h1>
          <p class="login-subtitle">Real-time messaging with Opal + Stimulus</p>

          <div class="login-form">
            <input
              type="text"
              data-chat-target="usernameInput"
              data-action="keypress->chat#handle_username_keypress"
              placeholder="Enter your username"
              class="username-input"
              autofocus
            />
            <button
              data-action="click->chat#join_chat"
              class="join-btn"
            >
              Join Chat
            </button>
          </div>

          <div class="info-box">
            <h3>Features</h3>
            <ul>
              <li>Real-time messaging with WebSocket</li>
              <li>Online user count</li>
              <li>Typing indicators</li>
              <li>Message history</li>
              <li>Auto-reconnect</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Chat Screen -->
      <div class="chat-container" data-chat-target="chatContainer" style="display: none;">
        <!-- Header -->
        <header class="chat-header">
          <h1>ðŸ’¬ WebSocket Chat</h1>
          <div class="user-count" data-chat-target="userCount">0 users online</div>
        </header>

        <!-- Messages -->
        <div class="messages-container" data-chat-target="messages">
          <!-- Messages will be added here dynamically -->
        </div>

        <!-- Typing Indicator -->
        <div class="typing-indicator" data-chat-target="typingIndicator" style="display: none;">
          Someone is typing...
        </div>

        <!-- Input -->
        <div class="input-container">
          <textarea
            data-chat-target="input"
            data-action="keypress->chat#handle_keypress"
            placeholder="Type your message... (Press Enter to send)"
            rows="1"
            class="message-input"
          ></textarea>
          <button
            data-action="click->chat#send_message"
            class="send-btn"
          >
            Send
          </button>
        </div>
      </div>
    </div>

    <script type="module" src="/app/javascript/application.js"></script>
  </body>
</html>
